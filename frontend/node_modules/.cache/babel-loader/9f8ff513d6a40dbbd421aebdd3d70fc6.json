{"ast":null,"code":"\"use strict\";\n\nvar _assertThisInitialized = require(\"/mnt/c/Users/riche/ThessianSound/ThessianSoundLLC/frontend/node_modules/@babel/runtime/helpers/assertThisInitialized\");\n\nvar _get = require(\"/mnt/c/Users/riche/ThessianSound/ThessianSoundLLC/frontend/node_modules/@babel/runtime/helpers/get\");\n\nvar _getPrototypeOf = require(\"/mnt/c/Users/riche/ThessianSound/ThessianSoundLLC/frontend/node_modules/@babel/runtime/helpers/getPrototypeOf\");\n\nvar _inherits = require(\"/mnt/c/Users/riche/ThessianSound/ThessianSoundLLC/frontend/node_modules/@babel/runtime/helpers/inherits\");\n\nvar _createSuper = require(\"/mnt/c/Users/riche/ThessianSound/ThessianSoundLLC/frontend/node_modules/@babel/runtime/helpers/createSuper\");\n\nvar _createForOfIteratorHelper = require(\"/mnt/c/Users/riche/ThessianSound/ThessianSoundLLC/frontend/node_modules/@babel/runtime/helpers/createForOfIteratorHelper\");\n\nvar _classCallCheck = require(\"/mnt/c/Users/riche/ThessianSound/ThessianSoundLLC/frontend/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/mnt/c/Users/riche/ThessianSound/ThessianSoundLLC/frontend/node_modules/@babel/runtime/helpers/createClass\");\n\nvar _require = require(\"tough-cookie\"),\n    CookieJar = _require.CookieJar;\n\nvar NodeImpl = require(\"./Node-impl\").implementation;\n\nvar NODE_TYPE = require(\"../node-type\");\n\nvar _require2 = require(\"../../utils\"),\n    mixin = _require2.mixin,\n    memoizeQuery = _require2.memoizeQuery;\n\nvar _require3 = require(\"../helpers/traversal\"),\n    firstChildWithHTMLLocalName = _require3.firstChildWithHTMLLocalName,\n    firstChildWithHTMLLocalNames = _require3.firstChildWithHTMLLocalNames,\n    firstDescendantWithHTMLLocalName = _require3.firstDescendantWithHTMLLocalName;\n\nvar whatwgURL = require(\"whatwg-url\");\n\nvar _require4 = require(\"../../level2/style\"),\n    StyleSheetList = _require4.StyleSheetList;\n\nvar _require5 = require(\"../helpers/internal-constants\"),\n    domSymbolTree = _require5.domSymbolTree;\n\nvar eventAccessors = require(\"../helpers/create-event-accessor\");\n\nvar _require6 = require(\"../helpers/strings\"),\n    asciiLowercase = _require6.asciiLowercase,\n    stripAndCollapseASCIIWhitespace = _require6.stripAndCollapseASCIIWhitespace;\n\nvar _require7 = require(\"../helpers/namespaces\"),\n    HTML_NS = _require7.HTML_NS,\n    SVG_NS = _require7.SVG_NS;\n\nvar DOMException = require(\"domexception\");\n\nvar HTMLToDOM = require(\"../../browser/htmltodom\");\n\nvar History = require(\"../generated/History\");\n\nvar Location = require(\"../generated/Location\");\n\nvar HTMLCollection = require(\"../generated/HTMLCollection\");\n\nvar NodeList = require(\"../generated/NodeList\");\n\nvar validateName = require(\"../helpers/validate-names\").name;\n\nvar _require8 = require(\"../helpers/validate-names\"),\n    validateAndExtract = _require8.validateAndExtract;\n\nvar resourceLoader = require(\"../../browser/resource-loader\");\n\nvar GlobalEventHandlersImpl = require(\"./GlobalEventHandlers-impl\").implementation;\n\nvar _require9 = require(\"../node\"),\n    clone = _require9.clone,\n    listOfElementsWithQualifiedName = _require9.listOfElementsWithQualifiedName,\n    listOfElementsWithNamespaceAndLocalName = _require9.listOfElementsWithNamespaceAndLocalName,\n    listOfElementsWithClassNames = _require9.listOfElementsWithClassNames;\n\nvar generatedAttr = require(\"../generated/Attr\");\n\nvar Comment = require(\"../generated/Comment\");\n\nvar ProcessingInstruction = require(\"../generated/ProcessingInstruction\");\n\nvar CDATASection = require(\"../generated/CDATASection\");\n\nvar Text = require(\"../generated/Text\");\n\nvar DocumentFragment = require(\"../generated/DocumentFragment\");\n\nvar DOMImplementation = require(\"../generated/DOMImplementation\");\n\nvar NonElementParentNodeImpl = require(\"./NonElementParentNode-impl\").implementation;\n\nvar ParentNodeImpl = require(\"./ParentNode-impl\").implementation;\n\nvar Element = require(\"../generated/Element\");\n\nvar HTMLUnknownElement = require(\"../generated/HTMLUnknownElement\");\n\nvar SVGElement = require(\"../generated/SVGElement\");\n\nvar TreeWalker = require(\"../generated/TreeWalker\");\n\nvar NodeIterator = require(\"../generated/NodeIterator\");\n\nvar CustomEvent = require(\"../generated/CustomEvent\");\n\nvar ErrorEvent = require(\"../generated/ErrorEvent\");\n\nvar Event = require(\"../generated/Event\");\n\nvar FocusEvent = require(\"../generated/FocusEvent\");\n\nvar HashChangeEvent = require(\"../generated/HashChangeEvent\");\n\nvar KeyboardEvent = require(\"../generated/KeyboardEvent\");\n\nvar MessageEvent = require(\"../generated/MessageEvent\");\n\nvar MouseEvent = require(\"../generated/MouseEvent\");\n\nvar PopStateEvent = require(\"../generated/PopStateEvent\");\n\nvar ProgressEvent = require(\"../generated/ProgressEvent\");\n\nvar TouchEvent = require(\"../generated/TouchEvent\");\n\nvar UIEvent = require(\"../generated/UIEvent\");\n\nfunction clearChildNodes(node) {\n  for (var child = domSymbolTree.firstChild(node); child; child = domSymbolTree.firstChild(node)) {\n    node.removeChild(child);\n  }\n}\n\nvar ResourceQueue = /*#__PURE__*/function () {\n  function ResourceQueue(paused) {\n    _classCallCheck(this, ResourceQueue);\n\n    this.paused = Boolean(paused);\n  }\n\n  _createClass(ResourceQueue, [{\n    key: \"push\",\n    value: function push(callback) {\n      var q = this;\n      var item = {\n        prev: q.tail,\n        check: function check() {\n          if (!q.paused && !this.prev && this.fired) {\n            callback(this.err, this.data, this.response);\n\n            if (this.next) {\n              this.next.prev = null;\n              this.next.check();\n            } else {\n              // q.tail===this\n              q.tail = null;\n            }\n          }\n        }\n      };\n\n      if (q.tail) {\n        q.tail.next = item;\n      }\n\n      q.tail = item;\n      return function (err, data, response) {\n        item.fired = 1;\n        item.err = err;\n        item.data = data;\n        item.response = response;\n        item.check();\n      };\n    }\n  }, {\n    key: \"resume\",\n    value: function resume() {\n      if (!this.paused) {\n        return;\n      }\n\n      this.paused = false;\n      var head = this.tail;\n\n      while (head && head.prev) {\n        head = head.prev;\n      }\n\n      if (head) {\n        head.check();\n      }\n    }\n  }]);\n\n  return ResourceQueue;\n}();\n\nvar RequestManager = /*#__PURE__*/function () {\n  function RequestManager() {\n    _classCallCheck(this, RequestManager);\n\n    this.openedRequests = [];\n  }\n\n  _createClass(RequestManager, [{\n    key: \"add\",\n    value: function add(req) {\n      this.openedRequests.push(req);\n    }\n  }, {\n    key: \"remove\",\n    value: function remove(req) {\n      var idx = this.openedRequests.indexOf(req);\n\n      if (idx !== -1) {\n        this.openedRequests.splice(idx, 1);\n      }\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      var _iterator = _createForOfIteratorHelper(this.openedRequests),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var openedRequest = _step.value;\n          openedRequest.abort();\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      this.openedRequests = [];\n    }\n  }, {\n    key: \"size\",\n    value: function size() {\n      return this.openedRequests.length;\n    }\n  }]);\n\n  return RequestManager;\n}();\n\nfunction pad(number) {\n  if (number < 10) {\n    return \"0\" + number;\n  }\n\n  return number;\n}\n\nfunction toLastModifiedString(date) {\n  return pad(date.getMonth() + 1) + \"/\" + pad(date.getDate()) + \"/\" + date.getFullYear() + \" \" + pad(date.getHours()) + \":\" + pad(date.getMinutes()) + \":\" + pad(date.getSeconds());\n}\n\nvar eventInterfaceTable = {\n  customevent: CustomEvent,\n  errorevent: ErrorEvent,\n  event: Event,\n  events: Event,\n  focusevent: FocusEvent,\n  hashchangeevent: HashChangeEvent,\n  htmlevents: Event,\n  keyboardevent: KeyboardEvent,\n  messageevent: MessageEvent,\n  mouseevent: MouseEvent,\n  mouseevents: MouseEvent,\n  popstateevent: PopStateEvent,\n  progressevent: ProgressEvent,\n  svgevents: Event,\n  touchevent: TouchEvent,\n  uievent: UIEvent,\n  uievents: UIEvent\n};\n\nvar DocumentImpl = /*#__PURE__*/function (_NodeImpl) {\n  _inherits(DocumentImpl, _NodeImpl);\n\n  var _super = _createSuper(DocumentImpl);\n\n  function DocumentImpl(args, privateData) {\n    var _this;\n\n    _classCallCheck(this, DocumentImpl);\n\n    _this = _super.call(this, args, privateData);\n\n    _this._initGlobalEvents();\n\n    _this._ownerDocument = _assertThisInitialized(_this);\n    _this.nodeType = NODE_TYPE.DOCUMENT_NODE;\n\n    if (!privateData.options) {\n      privateData.options = {};\n    }\n\n    if (!privateData.options.parsingMode) {\n      privateData.options.parsingMode = \"xml\";\n    }\n\n    if (!privateData.options.encoding) {\n      privateData.options.encoding = \"UTF-8\";\n    }\n\n    if (!privateData.options.contentType) {\n      privateData.options.contentType = privateData.options.parsingMode === \"xml\" ? \"application/xml\" : \"text/html\";\n    }\n\n    _this._parsingMode = privateData.options.parsingMode;\n    _this._htmlToDom = new HTMLToDOM(privateData.options.parsingMode);\n    _this._implementation = DOMImplementation.createImpl([], {\n      ownerDocument: _assertThisInitialized(_this)\n    });\n    _this._defaultView = privateData.options.defaultView || null;\n    _this._global = privateData.options.global;\n    _this._documentElement = null;\n    _this._ids = Object.create(null);\n    _this._attached = true;\n    _this._currentScript = null;\n    _this._cookieJar = privateData.options.cookieJar;\n    _this._parseOptions = privateData.options.parseOptions;\n\n    if (_this._cookieJar === undefined) {\n      _this._cookieJar = new CookieJar(null, {\n        looseMode: true\n      });\n    }\n\n    _this.contentType = privateData.options.contentType;\n    _this._encoding = privateData.options.encoding;\n    var urlOption = privateData.options.url === undefined ? \"about:blank\" : privateData.options.url;\n    var parsed = whatwgURL.parseURL(urlOption);\n\n    if (parsed === null) {\n      throw new TypeError(\"Could not parse \\\"\".concat(urlOption, \"\\\" as a URL\"));\n    }\n\n    _this._URL = parsed;\n    _this.origin = whatwgURL.serializeURLOrigin(parsed);\n    _this._location = Location.createImpl([], {\n      relevantDocument: _assertThisInitialized(_this)\n    });\n    _this._history = History.createImpl([], {\n      window: _this._defaultView,\n      document: _assertThisInitialized(_this),\n      actAsIfLocationReloadCalled: function actAsIfLocationReloadCalled() {\n        return _this._location.reload();\n      }\n    });\n\n    if (privateData.options.cookie) {\n      var cookies = Array.isArray(privateData.options.cookie) ? privateData.options.cookie : [privateData.options.cookie];\n\n      var document = _assertThisInitialized(_this);\n\n      cookies.forEach(function (cookieStr) {\n        document._cookieJar.setCookieSync(cookieStr, document.URL, {\n          ignoreError: true\n        });\n      });\n    }\n\n    _this._workingNodeIterators = [];\n    _this._workingNodeIteratorsMax = privateData.options.concurrentNodeIterators === undefined ? 10 : Number(privateData.options.concurrentNodeIterators);\n\n    if (isNaN(_this._workingNodeIteratorsMax)) {\n      throw new TypeError(\"The 'concurrentNodeIterators' option must be a Number\");\n    }\n\n    if (_this._workingNodeIteratorsMax < 0) {\n      throw new RangeError(\"The 'concurrentNodeIterators' option must be a non negative Number\");\n    }\n\n    _this._referrer = privateData.options.referrer || \"\";\n    _this._lastModified = toLastModifiedString(privateData.options.lastModified || new Date());\n    _this._queue = new ResourceQueue(privateData.options.deferClose);\n    _this._customResourceLoader = privateData.options.resourceLoader;\n    _this._pool = privateData.options.pool;\n    _this._agentOptions = privateData.options.agentOptions;\n    _this._strictSSL = privateData.options.strictSSL;\n    _this._proxy = privateData.options.proxy;\n    _this._requestManager = new RequestManager();\n    _this.readyState = \"loading\";\n    _this._lastFocusedElement = null; // Each Document in a browsing context can also have a latest entry. This is the entry for that Document\n    // to which the browsing context's session history was most recently traversed. When a Document is created,\n    // it initially has no latest entry.\n\n    _this._latestEntry = null;\n    return _this;\n  }\n\n  _createClass(DocumentImpl, [{\n    key: \"hasFocus\",\n    value: function hasFocus() {\n      return Boolean(this._lastFocusedElement);\n    }\n  }, {\n    key: \"_createElementWithCorrectElementInterface\",\n    value: function _createElementWithCorrectElementInterface(localName, namespace) {\n      // https://dom.spec.whatwg.org/#concept-element-interface\n      if (this._elementBuilders[namespace] && this._elementBuilders[namespace][localName]) {\n        return this._elementBuilders[namespace][localName](this, localName, namespace);\n      } else if (namespace === HTML_NS) {\n        return HTMLUnknownElement.createImpl([], {\n          ownerDocument: this,\n          localName: localName,\n          namespace: namespace\n        });\n      } else if (namespace === SVG_NS) {\n        return SVGElement.createImpl([], {\n          ownerDocument: this,\n          localName: localName,\n          namespace: namespace\n        });\n      }\n\n      return Element.createImpl([], {\n        ownerDocument: this,\n        localName: localName,\n        namespace: namespace\n      });\n    }\n  }, {\n    key: \"appendChild\",\n    value: function appendChild(\n    /* Node */\n    arg) {\n      if (this.documentElement && arg.nodeType === NODE_TYPE.ELEMENT_NODE) {\n        throw new DOMException(\"The operation would yield an incorrect node tree.\", \"HierarchyRequestError\");\n      }\n\n      return _get(_getPrototypeOf(DocumentImpl.prototype), \"appendChild\", this).call(this, arg);\n    }\n  }, {\n    key: \"removeChild\",\n    value: function removeChild(\n    /* Node */\n    arg) {\n      var ret = _get(_getPrototypeOf(DocumentImpl.prototype), \"removeChild\", this).call(this, arg);\n\n      if (arg === this._documentElement) {\n        this._documentElement = null; // force a recalculation\n      }\n\n      return ret;\n    }\n  }, {\n    key: \"_descendantRemoved\",\n    value: function _descendantRemoved(parent, child) {\n      if (child.tagName === \"STYLE\") {\n        var index = this.styleSheets.indexOf(child.sheet);\n\n        if (index > -1) {\n          this.styleSheets.splice(index, 1);\n        }\n      }\n    }\n  }, {\n    key: \"write\",\n    value: function write() {\n      var text = \"\";\n\n      for (var i = 0; i < arguments.length; ++i) {\n        text += String(arguments[i]);\n      }\n\n      if (this._parsingMode === \"xml\") {\n        throw new DOMException(\"Cannot use document.write on XML documents\", \"InvalidStateError\");\n      }\n\n      if (this._writeAfterElement) {\n        // If called from an script element directly (during the first tick),\n        // the new elements are inserted right after that element.\n        var tempDiv = this.createElement(\"div\");\n        tempDiv.innerHTML = text;\n        var child = tempDiv.firstChild;\n        var previous = this._writeAfterElement;\n        var parent = this._writeAfterElement.parentNode;\n\n        while (child) {\n          var node = child;\n          child = child.nextSibling;\n          node._isMovingDueToDocumentWrite = true; // hack for script execution\n\n          parent.insertBefore(node, previous.nextSibling);\n          node._isMovingDueToDocumentWrite = false;\n          previous = node;\n        }\n      } else if (this.readyState === \"loading\") {\n        // During page loading, document.write appends to the current element\n        // Find the last child that has been added to the document.\n        if (this.lastChild) {\n          var _node = this;\n\n          while (_node.lastChild && _node.lastChild.nodeType === NODE_TYPE.ELEMENT_NODE) {\n            _node = _node.lastChild;\n          }\n\n          _node.innerHTML = text;\n        } else {\n          clearChildNodes(this);\n\n          this._htmlToDom.appendToDocument(text, this);\n        }\n      } else if (text) {\n        clearChildNodes(this);\n\n        this._htmlToDom.appendToDocument(text, this);\n      }\n    }\n  }, {\n    key: \"writeln\",\n    value: function writeln() {\n      this.write.apply(this, Array.prototype.slice.call(arguments).concat([\"\\n\"]));\n    } // This is implemented separately for Document (which has a _ids cache) and DocumentFragment (which does not).\n\n  }, {\n    key: \"getElementById\",\n    value: function getElementById(id) {\n      // Return the first element with this ID.\n      return this._ids[id] && this._ids[id].length > 0 ? this._ids[id][0] : null;\n    }\n  }, {\n    key: \"open\",\n    value: function open() {\n      var child = domSymbolTree.firstChild(this);\n\n      while (child) {\n        this.removeChild(child);\n        child = domSymbolTree.firstChild(this);\n      }\n\n      this._documentElement = null;\n\n      this._modified();\n\n      return this;\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      this._queue.resume(); // Set the readyState to 'complete' once all resources are loaded.\n      // As a side-effect the document's load-event will be dispatched.\n\n\n      resourceLoader.enqueue(this, null, function () {\n        this.readyState = \"complete\";\n        var ev = this.createEvent(\"HTMLEvents\");\n        ev.initEvent(\"DOMContentLoaded\", false, false);\n        this.dispatchEvent(ev);\n      })(null, true);\n    }\n  }, {\n    key: \"getElementsByName\",\n    value: function getElementsByName(elementName) {\n      var _this2 = this;\n\n      return NodeList.createImpl([], {\n        element: this,\n        query: function query() {\n          return domSymbolTree.treeToArray(_this2, {\n            filter: function filter(node) {\n              return node.getAttribute && node.getAttribute(\"name\") === elementName;\n            }\n          });\n        }\n      });\n    }\n  }, {\n    key: \"_runPreRemovingSteps\",\n    value: function _runPreRemovingSteps(oldNode) {\n      var _iterator2 = _createForOfIteratorHelper(this._workingNodeIterators),\n          _step2;\n\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var activeNodeIterator = _step2.value;\n\n          activeNodeIterator._preRemovingSteps(oldNode);\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n    }\n  }, {\n    key: \"createEvent\",\n    value: function createEvent(type) {\n      var typeLower = type.toLowerCase();\n      var eventWrapper = eventInterfaceTable[typeLower] || null;\n\n      if (!eventWrapper) {\n        throw new DOMException(\"The provided event type (\\\"\" + type + \"\\\") is invalid\", \"NotSupportedError\");\n      }\n\n      var impl = eventWrapper.createImpl([\"\"]);\n      impl._initializedFlag = false;\n      return impl;\n    }\n  }, {\n    key: \"createProcessingInstruction\",\n    value: function createProcessingInstruction(target, data) {\n      validateName(target);\n\n      if (data.includes(\"?>\")) {\n        throw new DOMException(\"Processing instruction data cannot contain the string \\\"?>\\\"\", \"InvalidCharacterError\");\n      }\n\n      return ProcessingInstruction.createImpl([], {\n        ownerDocument: this,\n        target: target,\n        data: data\n      });\n    } // https://dom.spec.whatwg.org/#dom-document-createcdatasection\n\n  }, {\n    key: \"createCDATASection\",\n    value: function createCDATASection(data) {\n      if (this._parsingMode === \"html\") {\n        throw new DOMException(\"Cannot create CDATA sections in HTML documents\", \"NotSupportedError\");\n      }\n\n      if (data.includes(\"]]>\")) {\n        throw new DOMException(\"CDATA section data cannot contain the string \\\"]]>\\\"\", \"InvalidCharacterError\");\n      }\n\n      return CDATASection.createImpl([], {\n        ownerDocument: this,\n        data: data\n      });\n    }\n  }, {\n    key: \"createTextNode\",\n    value: function createTextNode(data) {\n      return Text.createImpl([], {\n        ownerDocument: this,\n        data: data\n      });\n    }\n  }, {\n    key: \"createComment\",\n    value: function createComment(data) {\n      return Comment.createImpl([], {\n        ownerDocument: this,\n        data: data\n      });\n    }\n  }, {\n    key: \"createElement\",\n    value: function createElement(localName) {\n      validateName(localName);\n\n      if (this._parsingMode === \"html\") {\n        localName = asciiLowercase(localName);\n      }\n\n      var namespace = this._parsingMode === \"html\" || this.contentType === \"application/xhtml+xml\" ? HTML_NS : null;\n      return this._createElementWithCorrectElementInterface(localName, namespace);\n    }\n  }, {\n    key: \"createElementNS\",\n    value: function createElementNS(namespace, qualifiedName) {\n      namespace = namespace !== null ? String(namespace) : namespace;\n      var extracted = validateAndExtract(namespace, qualifiedName);\n\n      var element = this._createElementWithCorrectElementInterface(extracted.localName, extracted.namespace);\n\n      element._prefix = extracted.prefix;\n      return element;\n    }\n  }, {\n    key: \"createDocumentFragment\",\n    value: function createDocumentFragment() {\n      return DocumentFragment.createImpl([], {\n        ownerDocument: this\n      });\n    }\n  }, {\n    key: \"createAttribute\",\n    value: function createAttribute(localName) {\n      validateName(localName);\n\n      if (this._parsingMode === \"html\") {\n        localName = asciiLowercase(localName);\n      }\n\n      return generatedAttr.createImpl([], {\n        localName: localName\n      });\n    }\n  }, {\n    key: \"createAttributeNS\",\n    value: function createAttributeNS(namespace, name) {\n      if (namespace === undefined) {\n        namespace = null;\n      }\n\n      namespace = namespace !== null ? String(namespace) : namespace;\n      var extracted = validateAndExtract(namespace, name);\n      return generatedAttr.createImpl([], {\n        namespace: extracted.namespace,\n        namespacePrefix: extracted.prefix,\n        localName: extracted.localName\n      });\n    } // TODO: Add callback interface support to `webidl2js`\n\n  }, {\n    key: \"createTreeWalker\",\n    value: function createTreeWalker(root, whatToShow, filter) {\n      return TreeWalker.createImpl([], {\n        root: root,\n        whatToShow: whatToShow,\n        filter: filter\n      });\n    }\n  }, {\n    key: \"createNodeIterator\",\n    value: function createNodeIterator(root, whatToShow, filter) {\n      var nodeIterator = NodeIterator.createImpl([], {\n        root: root,\n        whatToShow: whatToShow,\n        filter: filter\n      });\n\n      this._workingNodeIterators.push(nodeIterator);\n\n      while (this._workingNodeIterators.length > this._workingNodeIteratorsMax) {\n        var toInactivate = this._workingNodeIterators.shift();\n\n        toInactivate._working = false;\n      }\n\n      return nodeIterator;\n    }\n  }, {\n    key: \"importNode\",\n    value: function importNode(node, deep) {\n      if (node.nodeType === NODE_TYPE.DOCUMENT_NODE) {\n        throw new DOMException(\"Cannot import a document node\", \"NotSupportedError\");\n      }\n\n      return clone(node, this, deep);\n    }\n  }, {\n    key: \"adoptNode\",\n    value: function adoptNode(node) {\n      if (node.nodeType === NODE_TYPE.DOCUMENT_NODE) {\n        throw new DOMException(\"Cannot adopt a document node\", \"NotSupportedError\");\n      } // TODO: Determine correct way to detect a shadow root\n      // See also https://github.com/w3c/webcomponents/issues/182\n\n\n      if (node.parentNode) {\n        node.parentNode.removeChild(node);\n      }\n\n      node._ownerDocument = this;\n\n      var _iterator3 = _createForOfIteratorHelper(domSymbolTree.treeIterator(node)),\n          _step3;\n\n      try {\n        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n          var descendant = _step3.value;\n          descendant._ownerDocument = this;\n        }\n      } catch (err) {\n        _iterator3.e(err);\n      } finally {\n        _iterator3.f();\n      }\n\n      return node;\n    }\n  }, {\n    key: \"clear\",\n    // The clear(), captureEvents(), and releaseEvents() methods must do nothing\n    value: function clear() {}\n  }, {\n    key: \"captureEvents\",\n    value: function captureEvents() {}\n  }, {\n    key: \"releaseEvents\",\n    value: function releaseEvents() {}\n  }, {\n    key: \"compatMode\",\n    get: function get() {\n      return this._parsingMode === \"xml\" || this.doctype ? \"CSS1Compat\" : \"BackCompat\";\n    }\n  }, {\n    key: \"charset\",\n    get: function get() {\n      return this._encoding;\n    }\n  }, {\n    key: \"characterSet\",\n    get: function get() {\n      return this._encoding;\n    }\n  }, {\n    key: \"inputEncoding\",\n    get: function get() {\n      return this._encoding;\n    }\n  }, {\n    key: \"doctype\",\n    get: function get() {\n      var _iterator4 = _createForOfIteratorHelper(domSymbolTree.childrenIterator(this)),\n          _step4;\n\n      try {\n        for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n          var childNode = _step4.value;\n\n          if (childNode.nodeType === NODE_TYPE.DOCUMENT_TYPE_NODE) {\n            return childNode;\n          }\n        }\n      } catch (err) {\n        _iterator4.e(err);\n      } finally {\n        _iterator4.f();\n      }\n\n      return null;\n    }\n  }, {\n    key: \"URL\",\n    get: function get() {\n      return whatwgURL.serializeURL(this._URL);\n    }\n  }, {\n    key: \"documentURI\",\n    get: function get() {\n      return whatwgURL.serializeURL(this._URL);\n    }\n  }, {\n    key: \"location\",\n    get: function get() {\n      return this._defaultView ? this._location : null;\n    }\n  }, {\n    key: \"documentElement\",\n    get: function get() {\n      if (this._documentElement) {\n        return this._documentElement;\n      }\n\n      var _iterator5 = _createForOfIteratorHelper(domSymbolTree.childrenIterator(this)),\n          _step5;\n\n      try {\n        for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n          var childNode = _step5.value;\n\n          if (childNode.nodeType === NODE_TYPE.ELEMENT_NODE) {\n            this._documentElement = childNode;\n            return childNode;\n          }\n        }\n      } catch (err) {\n        _iterator5.e(err);\n      } finally {\n        _iterator5.f();\n      }\n\n      return null;\n    }\n  }, {\n    key: \"implementation\",\n    get: function get() {\n      return this._implementation;\n    },\n    set: function set(implementation) {\n      this._implementation = implementation;\n    }\n  }, {\n    key: \"defaultView\",\n    get: function get() {\n      return this._defaultView;\n    }\n  }, {\n    key: \"currentScript\",\n    get: function get() {\n      return this._currentScript;\n    }\n  }, {\n    key: \"activeElement\",\n    get: function get() {\n      if (this._lastFocusedElement) {\n        return this._lastFocusedElement;\n      }\n\n      return this.body;\n    }\n  }, {\n    key: \"referrer\",\n    get: function get() {\n      return this._referrer || \"\";\n    }\n  }, {\n    key: \"lastModified\",\n    get: function get() {\n      return this._lastModified;\n    }\n  }, {\n    key: \"images\",\n    get: function get() {\n      return this.getElementsByTagName(\"IMG\");\n    }\n  }, {\n    key: \"embeds\",\n    get: function get() {\n      return this.getElementsByTagName(\"EMBED\");\n    }\n  }, {\n    key: \"plugins\",\n    get: function get() {\n      return this.embeds;\n    }\n  }, {\n    key: \"links\",\n    get: function get() {\n      var _this3 = this;\n\n      return HTMLCollection.createImpl([], {\n        element: this,\n        query: function query() {\n          return domSymbolTree.treeToArray(_this3, {\n            filter: function filter(node) {\n              return (node._localName === \"a\" || node._localName === \"area\") && node.hasAttribute(\"href\") && node._namespaceURI === HTML_NS;\n            }\n          });\n        }\n      });\n    }\n  }, {\n    key: \"forms\",\n    get: function get() {\n      return this.getElementsByTagName(\"FORM\");\n    }\n  }, {\n    key: \"scripts\",\n    get: function get() {\n      return this.getElementsByTagName(\"SCRIPT\");\n    }\n  }, {\n    key: \"anchors\",\n    get: function get() {\n      var _this4 = this;\n\n      return HTMLCollection.createImpl([], {\n        element: this,\n        query: function query() {\n          return domSymbolTree.treeToArray(_this4, {\n            filter: function filter(node) {\n              return node._localName === \"a\" && node.hasAttribute(\"name\") && node._namespaceURI === HTML_NS;\n            }\n          });\n        }\n      });\n    } // The applets attribute must return an\n    // HTMLCollection rooted at the Document node,\n    // whose filter matches nothing.\n    // (It exists for historical reasons.)\n\n  }, {\n    key: \"applets\",\n    get: function get() {\n      return HTMLCollection.createImpl([], {\n        element: this,\n        query: function query() {\n          return [];\n        }\n      });\n    }\n  }, {\n    key: \"title\",\n    get: function get() {\n      // TODO SVG\n      var titleElement = firstDescendantWithHTMLLocalName(this, \"title\");\n      var value = titleElement !== null ? titleElement.textContent : \"\";\n      value = stripAndCollapseASCIIWhitespace(value);\n      return value;\n    },\n    set: function set(val) {\n      // TODO SVG\n      var titleElement = firstDescendantWithHTMLLocalName(this, \"title\");\n      var headElement = this.head;\n\n      if (titleElement === null && headElement === null) {\n        return;\n      }\n\n      var element;\n\n      if (titleElement !== null) {\n        element = titleElement;\n      } else {\n        element = this.createElement(\"title\");\n        headElement.appendChild(element);\n      }\n\n      element.textContent = val;\n    }\n  }, {\n    key: \"dir\",\n    get: function get() {\n      return this.documentElement ? this.documentElement.dir : \"\";\n    },\n    set: function set(value) {\n      if (this.documentElement) {\n        this.documentElement.dir = value;\n      }\n    }\n  }, {\n    key: \"head\",\n    get: function get() {\n      return this.documentElement ? firstChildWithHTMLLocalName(this.documentElement, \"head\") : null;\n    }\n  }, {\n    key: \"body\",\n    get: function get() {\n      var documentElement = this.documentElement;\n\n      if (!documentElement || documentElement._localName !== \"html\" || documentElement._namespaceURI !== HTML_NS) {\n        return null;\n      }\n\n      return firstChildWithHTMLLocalNames(this.documentElement, new Set([\"body\", \"frameset\"]));\n    },\n    set: function set(value) {\n      if (value === null || value._namespaceURI !== HTML_NS || value._localName !== \"body\" && value._localName !== \"frameset\") {\n        throw new DOMException(\"Cannot set the body to null or a non-body/frameset element\", \"HierarchyRequestError\");\n      }\n\n      var bodyElement = this.body;\n\n      if (value === bodyElement) {\n        return;\n      }\n\n      if (bodyElement !== null) {\n        bodyElement.parentNode.replaceChild(value, bodyElement);\n        return;\n      }\n\n      var documentElement = this.documentElement;\n\n      if (documentElement === null) {\n        throw new DOMException(\"Cannot set the body when there is no document element\", \"HierarchyRequestError\");\n      }\n\n      documentElement.appendChild(value);\n    }\n  }, {\n    key: \"cookie\",\n    get: function get() {\n      return this._cookieJar.getCookieStringSync(this.URL, {\n        http: false\n      });\n    },\n    set: function set(cookieStr) {\n      cookieStr = String(cookieStr);\n\n      this._cookieJar.setCookieSync(cookieStr, this.URL, {\n        http: false,\n        ignoreError: true\n      });\n    }\n  }, {\n    key: \"styleSheets\",\n    get: function get() {\n      if (!this._styleSheets) {\n        this._styleSheets = new StyleSheetList();\n      } // TODO: each style and link element should register its sheet on creation\n      // and remove it on removal.\n\n\n      return this._styleSheets;\n    }\n  }, {\n    key: \"hidden\",\n    get: function get() {\n      if (this._defaultView && this._defaultView._pretendToBeVisual) {\n        return false;\n      }\n\n      return true;\n    }\n  }, {\n    key: \"visibilityState\",\n    get: function get() {\n      if (this._defaultView && this._defaultView._pretendToBeVisual) {\n        return \"visible\";\n      }\n\n      return \"prerender\";\n    }\n  }]);\n\n  return DocumentImpl;\n}(NodeImpl);\n\neventAccessors.createEventAccessor(DocumentImpl.prototype, \"readystatechange\");\nmixin(DocumentImpl.prototype, GlobalEventHandlersImpl.prototype);\nmixin(DocumentImpl.prototype, NonElementParentNodeImpl.prototype);\nmixin(DocumentImpl.prototype, ParentNodeImpl.prototype);\nDocumentImpl.prototype._elementBuilders = Object.create(null);\nDocumentImpl.prototype.getElementsByTagName = memoizeQuery(function (qualifiedName) {\n  return listOfElementsWithQualifiedName(qualifiedName, this);\n});\nDocumentImpl.prototype.getElementsByTagNameNS = memoizeQuery(function (namespace, localName) {\n  return listOfElementsWithNamespaceAndLocalName(namespace, localName, this);\n});\nDocumentImpl.prototype.getElementsByClassName = memoizeQuery(function getElementsByClassName(classNames) {\n  return listOfElementsWithClassNames(classNames, this);\n});\nmodule.exports = {\n  implementation: DocumentImpl\n};","map":{"version":3,"sources":["/mnt/c/Users/riche/ThessianSound/ThessianSoundLLC/frontend/node_modules/jsdom/lib/jsdom/living/nodes/Document-impl.js"],"names":["require","CookieJar","NodeImpl","implementation","NODE_TYPE","mixin","memoizeQuery","firstChildWithHTMLLocalName","firstChildWithHTMLLocalNames","firstDescendantWithHTMLLocalName","whatwgURL","StyleSheetList","domSymbolTree","eventAccessors","asciiLowercase","stripAndCollapseASCIIWhitespace","HTML_NS","SVG_NS","DOMException","HTMLToDOM","History","Location","HTMLCollection","NodeList","validateName","name","validateAndExtract","resourceLoader","GlobalEventHandlersImpl","clone","listOfElementsWithQualifiedName","listOfElementsWithNamespaceAndLocalName","listOfElementsWithClassNames","generatedAttr","Comment","ProcessingInstruction","CDATASection","Text","DocumentFragment","DOMImplementation","NonElementParentNodeImpl","ParentNodeImpl","Element","HTMLUnknownElement","SVGElement","TreeWalker","NodeIterator","CustomEvent","ErrorEvent","Event","FocusEvent","HashChangeEvent","KeyboardEvent","MessageEvent","MouseEvent","PopStateEvent","ProgressEvent","TouchEvent","UIEvent","clearChildNodes","node","child","firstChild","removeChild","ResourceQueue","paused","Boolean","callback","q","item","prev","tail","check","fired","err","data","response","next","head","RequestManager","openedRequests","req","push","idx","indexOf","splice","openedRequest","abort","length","pad","number","toLastModifiedString","date","getMonth","getDate","getFullYear","getHours","getMinutes","getSeconds","eventInterfaceTable","customevent","errorevent","event","events","focusevent","hashchangeevent","htmlevents","keyboardevent","messageevent","mouseevent","mouseevents","popstateevent","progressevent","svgevents","touchevent","uievent","uievents","DocumentImpl","args","privateData","_initGlobalEvents","_ownerDocument","nodeType","DOCUMENT_NODE","options","parsingMode","encoding","contentType","_parsingMode","_htmlToDom","_implementation","createImpl","ownerDocument","_defaultView","defaultView","_global","global","_documentElement","_ids","Object","create","_attached","_currentScript","_cookieJar","cookieJar","_parseOptions","parseOptions","undefined","looseMode","_encoding","urlOption","url","parsed","parseURL","TypeError","_URL","origin","serializeURLOrigin","_location","relevantDocument","_history","window","document","actAsIfLocationReloadCalled","reload","cookie","cookies","Array","isArray","forEach","cookieStr","setCookieSync","URL","ignoreError","_workingNodeIterators","_workingNodeIteratorsMax","concurrentNodeIterators","Number","isNaN","RangeError","_referrer","referrer","_lastModified","lastModified","Date","_queue","deferClose","_customResourceLoader","_pool","pool","_agentOptions","agentOptions","_strictSSL","strictSSL","_proxy","proxy","_requestManager","readyState","_lastFocusedElement","_latestEntry","localName","namespace","_elementBuilders","arg","documentElement","ELEMENT_NODE","ret","parent","tagName","index","styleSheets","sheet","text","i","arguments","String","_writeAfterElement","tempDiv","createElement","innerHTML","previous","parentNode","nextSibling","_isMovingDueToDocumentWrite","insertBefore","lastChild","appendToDocument","write","id","_modified","resume","enqueue","ev","createEvent","initEvent","dispatchEvent","elementName","element","query","treeToArray","filter","getAttribute","oldNode","activeNodeIterator","_preRemovingSteps","type","typeLower","toLowerCase","eventWrapper","impl","_initializedFlag","target","includes","_createElementWithCorrectElementInterface","qualifiedName","extracted","_prefix","prefix","namespacePrefix","root","whatToShow","nodeIterator","toInactivate","shift","_working","deep","treeIterator","descendant","doctype","childrenIterator","childNode","DOCUMENT_TYPE_NODE","serializeURL","body","getElementsByTagName","embeds","_localName","hasAttribute","_namespaceURI","titleElement","value","textContent","val","headElement","appendChild","dir","Set","bodyElement","replaceChild","getCookieStringSync","http","_styleSheets","_pretendToBeVisual","createEventAccessor","prototype","getElementsByTagNameNS","getElementsByClassName","classNames","module","exports"],"mappings":"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","sourcesContent":["\"use strict\";\n\nconst { CookieJar } = require(\"tough-cookie\");\n\nconst NodeImpl = require(\"./Node-impl\").implementation;\n\nconst NODE_TYPE = require(\"../node-type\");\nconst { mixin, memoizeQuery } = require(\"../../utils\");\nconst { firstChildWithHTMLLocalName, firstChildWithHTMLLocalNames, firstDescendantWithHTMLLocalName } =\n  require(\"../helpers/traversal\");\nconst whatwgURL = require(\"whatwg-url\");\nconst { StyleSheetList } = require(\"../../level2/style\");\nconst { domSymbolTree } = require(\"../helpers/internal-constants\");\nconst eventAccessors = require(\"../helpers/create-event-accessor\");\nconst { asciiLowercase, stripAndCollapseASCIIWhitespace } = require(\"../helpers/strings\");\nconst { HTML_NS, SVG_NS } = require(\"../helpers/namespaces\");\nconst DOMException = require(\"domexception\");\nconst HTMLToDOM = require(\"../../browser/htmltodom\");\nconst History = require(\"../generated/History\");\nconst Location = require(\"../generated/Location\");\nconst HTMLCollection = require(\"../generated/HTMLCollection\");\nconst NodeList = require(\"../generated/NodeList\");\nconst validateName = require(\"../helpers/validate-names\").name;\nconst { validateAndExtract } = require(\"../helpers/validate-names\");\nconst resourceLoader = require(\"../../browser/resource-loader\");\n\nconst GlobalEventHandlersImpl = require(\"./GlobalEventHandlers-impl\").implementation;\n\nconst { clone, listOfElementsWithQualifiedName, listOfElementsWithNamespaceAndLocalName,\n  listOfElementsWithClassNames } = require(\"../node\");\nconst generatedAttr = require(\"../generated/Attr\");\nconst Comment = require(\"../generated/Comment\");\nconst ProcessingInstruction = require(\"../generated/ProcessingInstruction\");\nconst CDATASection = require(\"../generated/CDATASection\");\nconst Text = require(\"../generated/Text\");\nconst DocumentFragment = require(\"../generated/DocumentFragment\");\nconst DOMImplementation = require(\"../generated/DOMImplementation\");\nconst NonElementParentNodeImpl = require(\"./NonElementParentNode-impl\").implementation;\nconst ParentNodeImpl = require(\"./ParentNode-impl\").implementation;\nconst Element = require(\"../generated/Element\");\nconst HTMLUnknownElement = require(\"../generated/HTMLUnknownElement\");\nconst SVGElement = require(\"../generated/SVGElement\");\nconst TreeWalker = require(\"../generated/TreeWalker\");\nconst NodeIterator = require(\"../generated/NodeIterator\");\n\nconst CustomEvent = require(\"../generated/CustomEvent\");\nconst ErrorEvent = require(\"../generated/ErrorEvent\");\nconst Event = require(\"../generated/Event\");\nconst FocusEvent = require(\"../generated/FocusEvent\");\nconst HashChangeEvent = require(\"../generated/HashChangeEvent\");\nconst KeyboardEvent = require(\"../generated/KeyboardEvent\");\nconst MessageEvent = require(\"../generated/MessageEvent\");\nconst MouseEvent = require(\"../generated/MouseEvent\");\nconst PopStateEvent = require(\"../generated/PopStateEvent\");\nconst ProgressEvent = require(\"../generated/ProgressEvent\");\nconst TouchEvent = require(\"../generated/TouchEvent\");\nconst UIEvent = require(\"../generated/UIEvent\");\n\nfunction clearChildNodes(node) {\n  for (let child = domSymbolTree.firstChild(node); child; child = domSymbolTree.firstChild(node)) {\n    node.removeChild(child);\n  }\n}\n\nclass ResourceQueue {\n  constructor(paused) {\n    this.paused = Boolean(paused);\n  }\n\n  push(callback) {\n    const q = this;\n    const item = {\n      prev: q.tail,\n      check() {\n        if (!q.paused && !this.prev && this.fired) {\n          callback(this.err, this.data, this.response);\n          if (this.next) {\n            this.next.prev = null;\n            this.next.check();\n          } else { // q.tail===this\n            q.tail = null;\n          }\n        }\n      }\n    };\n    if (q.tail) {\n      q.tail.next = item;\n    }\n    q.tail = item;\n    return (err, data, response) => {\n      item.fired = 1;\n      item.err = err;\n      item.data = data;\n      item.response = response;\n      item.check();\n    };\n  }\n\n  resume() {\n    if (!this.paused) {\n      return;\n    }\n    this.paused = false;\n\n    let head = this.tail;\n    while (head && head.prev) {\n      head = head.prev;\n    }\n    if (head) {\n      head.check();\n    }\n  }\n}\n\nclass RequestManager {\n  constructor() {\n    this.openedRequests = [];\n  }\n\n  add(req) {\n    this.openedRequests.push(req);\n  }\n\n  remove(req) {\n    const idx = this.openedRequests.indexOf(req);\n    if (idx !== -1) {\n      this.openedRequests.splice(idx, 1);\n    }\n  }\n\n  close() {\n    for (const openedRequest of this.openedRequests) {\n      openedRequest.abort();\n    }\n    this.openedRequests = [];\n  }\n\n  size() {\n    return this.openedRequests.length;\n  }\n}\n\nfunction pad(number) {\n  if (number < 10) {\n    return \"0\" + number;\n  }\n  return number;\n}\n\nfunction toLastModifiedString(date) {\n  return pad(date.getMonth() + 1) +\n    \"/\" + pad(date.getDate()) +\n    \"/\" + date.getFullYear() +\n    \" \" + pad(date.getHours()) +\n    \":\" + pad(date.getMinutes()) +\n    \":\" + pad(date.getSeconds());\n}\n\nconst eventInterfaceTable = {\n  customevent: CustomEvent,\n  errorevent: ErrorEvent,\n  event: Event,\n  events: Event,\n  focusevent: FocusEvent,\n  hashchangeevent: HashChangeEvent,\n  htmlevents: Event,\n  keyboardevent: KeyboardEvent,\n  messageevent: MessageEvent,\n  mouseevent: MouseEvent,\n  mouseevents: MouseEvent,\n  popstateevent: PopStateEvent,\n  progressevent: ProgressEvent,\n  svgevents: Event,\n  touchevent: TouchEvent,\n  uievent: UIEvent,\n  uievents: UIEvent\n};\n\nclass DocumentImpl extends NodeImpl {\n  constructor(args, privateData) {\n    super(args, privateData);\n\n    this._initGlobalEvents();\n\n    this._ownerDocument = this;\n    this.nodeType = NODE_TYPE.DOCUMENT_NODE;\n    if (!privateData.options) {\n      privateData.options = {};\n    }\n    if (!privateData.options.parsingMode) {\n      privateData.options.parsingMode = \"xml\";\n    }\n    if (!privateData.options.encoding) {\n      privateData.options.encoding = \"UTF-8\";\n    }\n    if (!privateData.options.contentType) {\n      privateData.options.contentType = privateData.options.parsingMode === \"xml\" ? \"application/xml\" : \"text/html\";\n    }\n\n    this._parsingMode = privateData.options.parsingMode;\n    this._htmlToDom = new HTMLToDOM(privateData.options.parsingMode);\n\n    this._implementation = DOMImplementation.createImpl([], {\n      ownerDocument: this\n    });\n\n    this._defaultView = privateData.options.defaultView || null;\n    this._global = privateData.options.global;\n    this._documentElement = null;\n    this._ids = Object.create(null);\n    this._attached = true;\n    this._currentScript = null;\n    this._cookieJar = privateData.options.cookieJar;\n    this._parseOptions = privateData.options.parseOptions;\n    if (this._cookieJar === undefined) {\n      this._cookieJar = new CookieJar(null, { looseMode: true });\n    }\n\n    this.contentType = privateData.options.contentType;\n    this._encoding = privateData.options.encoding;\n\n    const urlOption = privateData.options.url === undefined ? \"about:blank\" : privateData.options.url;\n    const parsed = whatwgURL.parseURL(urlOption);\n    if (parsed === null) {\n      throw new TypeError(`Could not parse \"${urlOption}\" as a URL`);\n    }\n\n    this._URL = parsed;\n    this.origin = whatwgURL.serializeURLOrigin(parsed);\n\n    this._location = Location.createImpl([], { relevantDocument: this });\n    this._history = History.createImpl([], {\n      window: this._defaultView,\n      document: this,\n      actAsIfLocationReloadCalled: () => this._location.reload()\n    });\n\n    if (privateData.options.cookie) {\n      const cookies = Array.isArray(privateData.options.cookie) ?\n                      privateData.options.cookie :\n                      [privateData.options.cookie];\n      const document = this;\n\n      cookies.forEach(cookieStr => {\n        document._cookieJar.setCookieSync(cookieStr, document.URL, { ignoreError: true });\n      });\n    }\n\n    this._workingNodeIterators = [];\n    this._workingNodeIteratorsMax = privateData.options.concurrentNodeIterators === undefined ?\n                                    10 :\n                                    Number(privateData.options.concurrentNodeIterators);\n\n    if (isNaN(this._workingNodeIteratorsMax)) {\n      throw new TypeError(\"The 'concurrentNodeIterators' option must be a Number\");\n    }\n\n    if (this._workingNodeIteratorsMax < 0) {\n      throw new RangeError(\"The 'concurrentNodeIterators' option must be a non negative Number\");\n    }\n\n    this._referrer = privateData.options.referrer || \"\";\n    this._lastModified = toLastModifiedString(privateData.options.lastModified || new Date());\n    this._queue = new ResourceQueue(privateData.options.deferClose);\n    this._customResourceLoader = privateData.options.resourceLoader;\n    this._pool = privateData.options.pool;\n    this._agentOptions = privateData.options.agentOptions;\n    this._strictSSL = privateData.options.strictSSL;\n    this._proxy = privateData.options.proxy;\n    this._requestManager = new RequestManager();\n    this.readyState = \"loading\";\n\n    this._lastFocusedElement = null;\n\n    // Each Document in a browsing context can also have a latest entry. This is the entry for that Document\n    // to which the browsing context's session history was most recently traversed. When a Document is created,\n    // it initially has no latest entry.\n    this._latestEntry = null;\n  }\n\n  get compatMode() {\n    return this._parsingMode === \"xml\" || this.doctype ? \"CSS1Compat\" : \"BackCompat\";\n  }\n  get charset() {\n    return this._encoding;\n  }\n  get characterSet() {\n    return this._encoding;\n  }\n  get inputEncoding() {\n    return this._encoding;\n  }\n  get doctype() {\n    for (const childNode of domSymbolTree.childrenIterator(this)) {\n      if (childNode.nodeType === NODE_TYPE.DOCUMENT_TYPE_NODE) {\n        return childNode;\n      }\n    }\n    return null;\n  }\n  get URL() {\n    return whatwgURL.serializeURL(this._URL);\n  }\n  get documentURI() {\n    return whatwgURL.serializeURL(this._URL);\n  }\n  get location() {\n    return this._defaultView ? this._location : null;\n  }\n  get documentElement() {\n    if (this._documentElement) {\n      return this._documentElement;\n    }\n\n    for (const childNode of domSymbolTree.childrenIterator(this)) {\n      if (childNode.nodeType === NODE_TYPE.ELEMENT_NODE) {\n        this._documentElement = childNode;\n        return childNode;\n      }\n    }\n\n    return null;\n  }\n\n  get implementation() {\n    return this._implementation;\n  }\n  set implementation(implementation) {\n    this._implementation = implementation;\n  }\n\n  get defaultView() {\n    return this._defaultView;\n  }\n\n  get currentScript() {\n    return this._currentScript;\n  }\n\n  get activeElement() {\n    if (this._lastFocusedElement) {\n      return this._lastFocusedElement;\n    }\n\n    return this.body;\n  }\n\n  hasFocus() {\n    return Boolean(this._lastFocusedElement);\n  }\n\n  _createElementWithCorrectElementInterface(localName, namespace) {\n    // https://dom.spec.whatwg.org/#concept-element-interface\n\n    if (this._elementBuilders[namespace] && this._elementBuilders[namespace][localName]) {\n      return this._elementBuilders[namespace][localName](this, localName, namespace);\n    } else if (namespace === HTML_NS) {\n      return HTMLUnknownElement.createImpl([], {\n        ownerDocument: this,\n        localName,\n        namespace\n      });\n    } else if (namespace === SVG_NS) {\n      return SVGElement.createImpl([], {\n        ownerDocument: this,\n        localName,\n        namespace\n      });\n    }\n\n    return Element.createImpl([], {\n      ownerDocument: this,\n      localName,\n      namespace\n    });\n  }\n\n  appendChild(/* Node */ arg) {\n    if (this.documentElement && arg.nodeType === NODE_TYPE.ELEMENT_NODE) {\n      throw new DOMException(\"The operation would yield an incorrect node tree.\", \"HierarchyRequestError\");\n    }\n    return super.appendChild(arg);\n  }\n\n  removeChild(/* Node */ arg) {\n    const ret = super.removeChild(arg);\n    if (arg === this._documentElement) {\n      this._documentElement = null;// force a recalculation\n    }\n    return ret;\n  }\n\n  _descendantRemoved(parent, child) {\n    if (child.tagName === \"STYLE\") {\n      const index = this.styleSheets.indexOf(child.sheet);\n      if (index > -1) {\n        this.styleSheets.splice(index, 1);\n      }\n    }\n  }\n\n  write() {\n    let text = \"\";\n    for (let i = 0; i < arguments.length; ++i) {\n      text += String(arguments[i]);\n    }\n\n    if (this._parsingMode === \"xml\") {\n      throw new DOMException(\"Cannot use document.write on XML documents\", \"InvalidStateError\");\n    }\n\n    if (this._writeAfterElement) {\n      // If called from an script element directly (during the first tick),\n      // the new elements are inserted right after that element.\n      const tempDiv = this.createElement(\"div\");\n      tempDiv.innerHTML = text;\n\n      let child = tempDiv.firstChild;\n      let previous = this._writeAfterElement;\n      const parent = this._writeAfterElement.parentNode;\n\n      while (child) {\n        const node = child;\n        child = child.nextSibling;\n\n        node._isMovingDueToDocumentWrite = true; // hack for script execution\n        parent.insertBefore(node, previous.nextSibling);\n        node._isMovingDueToDocumentWrite = false;\n\n        previous = node;\n      }\n    } else if (this.readyState === \"loading\") {\n      // During page loading, document.write appends to the current element\n      // Find the last child that has been added to the document.\n      if (this.lastChild) {\n        let node = this;\n        while (node.lastChild && node.lastChild.nodeType === NODE_TYPE.ELEMENT_NODE) {\n          node = node.lastChild;\n        }\n        node.innerHTML = text;\n      } else {\n        clearChildNodes(this);\n        this._htmlToDom.appendToDocument(text, this);\n      }\n    } else if (text) {\n      clearChildNodes(this);\n      this._htmlToDom.appendToDocument(text, this);\n    }\n  }\n\n  writeln() {\n    this.write(...arguments, \"\\n\");\n  }\n\n  // This is implemented separately for Document (which has a _ids cache) and DocumentFragment (which does not).\n  getElementById(id) {\n    // Return the first element with this ID.\n    return this._ids[id] && this._ids[id].length > 0 ? this._ids[id][0] : null;\n  }\n\n  get referrer() {\n    return this._referrer || \"\";\n  }\n  get lastModified() {\n    return this._lastModified;\n  }\n  get images() {\n    return this.getElementsByTagName(\"IMG\");\n  }\n  get embeds() {\n    return this.getElementsByTagName(\"EMBED\");\n  }\n  get plugins() {\n    return this.embeds;\n  }\n  get links() {\n    return HTMLCollection.createImpl([], {\n      element: this,\n      query: () => domSymbolTree.treeToArray(this, {\n        filter: node => (node._localName === \"a\" || node._localName === \"area\") &&\n                        node.hasAttribute(\"href\") &&\n                        node._namespaceURI === HTML_NS\n      })\n    });\n  }\n  get forms() {\n    return this.getElementsByTagName(\"FORM\");\n  }\n  get scripts() {\n    return this.getElementsByTagName(\"SCRIPT\");\n  }\n  get anchors() {\n    return HTMLCollection.createImpl([], {\n      element: this,\n      query: () => domSymbolTree.treeToArray(this, {\n        filter: node => node._localName === \"a\" &&\n                        node.hasAttribute(\"name\") &&\n                        node._namespaceURI === HTML_NS\n      })\n    });\n  }\n\n  // The applets attribute must return an\n  // HTMLCollection rooted at the Document node,\n  // whose filter matches nothing.\n  // (It exists for historical reasons.)\n  get applets() {\n    return HTMLCollection.createImpl([], {\n      element: this,\n      query: () => []\n    });\n  }\n\n  open() {\n    let child = domSymbolTree.firstChild(this);\n    while (child) {\n      this.removeChild(child);\n      child = domSymbolTree.firstChild(this);\n    }\n    this._documentElement = null;\n    this._modified();\n    return this;\n  }\n  close() {\n    this._queue.resume();\n\n    // Set the readyState to 'complete' once all resources are loaded.\n    // As a side-effect the document's load-event will be dispatched.\n    resourceLoader.enqueue(this, null, function () {\n      this.readyState = \"complete\";\n      const ev = this.createEvent(\"HTMLEvents\");\n      ev.initEvent(\"DOMContentLoaded\", false, false);\n      this.dispatchEvent(ev);\n    })(null, true);\n  }\n\n  getElementsByName(elementName) {\n    return NodeList.createImpl([], {\n      element: this,\n      query: () => domSymbolTree.treeToArray(this, {\n        filter: node => node.getAttribute && node.getAttribute(\"name\") === elementName\n      })\n    });\n  }\n\n  get title() {\n    // TODO SVG\n\n    const titleElement = firstDescendantWithHTMLLocalName(this, \"title\");\n    let value = titleElement !== null ? titleElement.textContent : \"\";\n    value = stripAndCollapseASCIIWhitespace(value);\n    return value;\n  }\n\n  set title(val) {\n    // TODO SVG\n\n    const titleElement = firstDescendantWithHTMLLocalName(this, \"title\");\n    const headElement = this.head;\n\n    if (titleElement === null && headElement === null) {\n      return;\n    }\n\n    let element;\n    if (titleElement !== null) {\n      element = titleElement;\n    } else {\n      element = this.createElement(\"title\");\n      headElement.appendChild(element);\n    }\n\n    element.textContent = val;\n  }\n\n  get dir() {\n    return this.documentElement ? this.documentElement.dir : \"\";\n  }\n  set dir(value) {\n    if (this.documentElement) {\n      this.documentElement.dir = value;\n    }\n  }\n\n  get head() {\n    return this.documentElement ? firstChildWithHTMLLocalName(this.documentElement, \"head\") : null;\n  }\n\n  get body() {\n    const { documentElement } = this;\n    if (!documentElement || documentElement._localName !== \"html\" ||\n        documentElement._namespaceURI !== HTML_NS) {\n      return null;\n    }\n\n    return firstChildWithHTMLLocalNames(this.documentElement, new Set([\"body\", \"frameset\"]));\n  }\n\n  set body(value) {\n    if (value === null ||\n        value._namespaceURI !== HTML_NS ||\n        (value._localName !== \"body\" && value._localName !== \"frameset\")) {\n      throw new DOMException(\"Cannot set the body to null or a non-body/frameset element\", \"HierarchyRequestError\");\n    }\n\n    const bodyElement = this.body;\n    if (value === bodyElement) {\n      return;\n    }\n\n    if (bodyElement !== null) {\n      bodyElement.parentNode.replaceChild(value, bodyElement);\n      return;\n    }\n\n    const { documentElement } = this;\n    if (documentElement === null) {\n      throw new DOMException(\"Cannot set the body when there is no document element\", \"HierarchyRequestError\");\n    }\n\n    documentElement.appendChild(value);\n  }\n\n  _runPreRemovingSteps(oldNode) {\n    for (const activeNodeIterator of this._workingNodeIterators) {\n      activeNodeIterator._preRemovingSteps(oldNode);\n    }\n  }\n\n  createEvent(type) {\n    const typeLower = type.toLowerCase();\n    const eventWrapper = eventInterfaceTable[typeLower] || null;\n\n    if (!eventWrapper) {\n      throw new DOMException(\"The provided event type (\\\"\" + type + \"\\\") is invalid\", \"NotSupportedError\");\n    }\n\n    const impl = eventWrapper.createImpl([\"\"]);\n    impl._initializedFlag = false;\n    return impl;\n  }\n\n  createProcessingInstruction(target, data) {\n    validateName(target);\n\n    if (data.includes(\"?>\")) {\n      throw new DOMException(\"Processing instruction data cannot contain the string \\\"?>\\\"\", \"InvalidCharacterError\");\n    }\n\n    return ProcessingInstruction.createImpl([], {\n      ownerDocument: this,\n      target,\n      data\n    });\n  }\n\n  // https://dom.spec.whatwg.org/#dom-document-createcdatasection\n  createCDATASection(data) {\n    if (this._parsingMode === \"html\") {\n      throw new DOMException(\"Cannot create CDATA sections in HTML documents\", \"NotSupportedError\");\n    }\n\n    if (data.includes(\"]]>\")) {\n      throw new DOMException(\"CDATA section data cannot contain the string \\\"]]>\\\"\", \"InvalidCharacterError\");\n    }\n\n    return CDATASection.createImpl([], {\n      ownerDocument: this,\n      data\n    });\n  }\n\n  createTextNode(data) {\n    return Text.createImpl([], {\n      ownerDocument: this,\n      data\n    });\n  }\n\n  createComment(data) {\n    return Comment.createImpl([], {\n      ownerDocument: this,\n      data\n    });\n  }\n\n  createElement(localName) {\n    validateName(localName);\n    if (this._parsingMode === \"html\") {\n      localName = asciiLowercase(localName);\n    }\n\n    const namespace = this._parsingMode === \"html\" || this.contentType === \"application/xhtml+xml\" ? HTML_NS : null;\n\n    return this._createElementWithCorrectElementInterface(localName, namespace);\n  }\n\n  createElementNS(namespace, qualifiedName) {\n    namespace = namespace !== null ? String(namespace) : namespace;\n\n    const extracted = validateAndExtract(namespace, qualifiedName);\n\n    const element = this._createElementWithCorrectElementInterface(extracted.localName, extracted.namespace);\n    element._prefix = extracted.prefix;\n\n    return element;\n  }\n\n  createDocumentFragment() {\n    return DocumentFragment.createImpl([], { ownerDocument: this });\n  }\n\n  createAttribute(localName) {\n    validateName(localName);\n\n    if (this._parsingMode === \"html\") {\n      localName = asciiLowercase(localName);\n    }\n\n    return generatedAttr.createImpl([], { localName });\n  }\n\n  createAttributeNS(namespace, name) {\n    if (namespace === undefined) {\n      namespace = null;\n    }\n    namespace = namespace !== null ? String(namespace) : namespace;\n\n    const extracted = validateAndExtract(namespace, name);\n    return generatedAttr.createImpl([], {\n      namespace: extracted.namespace,\n      namespacePrefix: extracted.prefix,\n      localName: extracted.localName\n    });\n  }\n\n  // TODO: Add callback interface support to `webidl2js`\n  createTreeWalker(root, whatToShow, filter) {\n    return TreeWalker.createImpl([], { root, whatToShow, filter });\n  }\n\n  createNodeIterator(root, whatToShow, filter) {\n    const nodeIterator = NodeIterator.createImpl([], { root, whatToShow, filter });\n\n    this._workingNodeIterators.push(nodeIterator);\n    while (this._workingNodeIterators.length > this._workingNodeIteratorsMax) {\n      const toInactivate = this._workingNodeIterators.shift();\n      toInactivate._working = false;\n    }\n\n    return nodeIterator;\n  }\n\n  importNode(node, deep) {\n    if (node.nodeType === NODE_TYPE.DOCUMENT_NODE) {\n      throw new DOMException(\"Cannot import a document node\", \"NotSupportedError\");\n    }\n\n    return clone(node, this, deep);\n  }\n\n  adoptNode(node) {\n    if (node.nodeType === NODE_TYPE.DOCUMENT_NODE) {\n      throw new DOMException(\"Cannot adopt a document node\", \"NotSupportedError\");\n    }\n    // TODO: Determine correct way to detect a shadow root\n    // See also https://github.com/w3c/webcomponents/issues/182\n\n    if (node.parentNode) {\n      node.parentNode.removeChild(node);\n    }\n    node._ownerDocument = this;\n    for (const descendant of domSymbolTree.treeIterator(node)) {\n      descendant._ownerDocument = this;\n    }\n\n    return node;\n  }\n\n  get cookie() {\n    return this._cookieJar.getCookieStringSync(this.URL, { http: false });\n  }\n  set cookie(cookieStr) {\n    cookieStr = String(cookieStr);\n    this._cookieJar.setCookieSync(cookieStr, this.URL, {\n      http: false,\n      ignoreError: true\n    });\n  }\n\n  // The clear(), captureEvents(), and releaseEvents() methods must do nothing\n  clear() {}\n\n  captureEvents() {}\n\n  releaseEvents() {}\n\n  get styleSheets() {\n    if (!this._styleSheets) {\n      this._styleSheets = new StyleSheetList();\n    }\n\n    // TODO: each style and link element should register its sheet on creation\n    // and remove it on removal.\n    return this._styleSheets;\n  }\n\n  get hidden() {\n    if (this._defaultView && this._defaultView._pretendToBeVisual) {\n      return false;\n    }\n\n    return true;\n  }\n\n  get visibilityState() {\n    if (this._defaultView && this._defaultView._pretendToBeVisual) {\n      return \"visible\";\n    }\n\n    return \"prerender\";\n  }\n}\n\neventAccessors.createEventAccessor(DocumentImpl.prototype, \"readystatechange\");\nmixin(DocumentImpl.prototype, GlobalEventHandlersImpl.prototype);\nmixin(DocumentImpl.prototype, NonElementParentNodeImpl.prototype);\nmixin(DocumentImpl.prototype, ParentNodeImpl.prototype);\n\nDocumentImpl.prototype._elementBuilders = Object.create(null);\n\nDocumentImpl.prototype.getElementsByTagName = memoizeQuery(function (qualifiedName) {\n  return listOfElementsWithQualifiedName(qualifiedName, this);\n});\n\nDocumentImpl.prototype.getElementsByTagNameNS = memoizeQuery(function (namespace, localName) {\n  return listOfElementsWithNamespaceAndLocalName(namespace, localName, this);\n});\n\nDocumentImpl.prototype.getElementsByClassName = memoizeQuery(function getElementsByClassName(classNames) {\n  return listOfElementsWithClassNames(classNames, this);\n});\n\nmodule.exports = {\n  implementation: DocumentImpl\n};\n"]},"metadata":{},"sourceType":"script"}