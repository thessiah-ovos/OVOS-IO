{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/mnt/c/Users/riche/ThessianSound/ThessianSoundLLC/frontend/node_modules/@babel/runtime/regenerator\");\n\nvar _createForOfIteratorHelper = require(\"/mnt/c/Users/riche/ThessianSound/ThessianSoundLLC/frontend/node_modules/@babel/runtime/helpers/createForOfIteratorHelper\");\n\nvar _classCallCheck = require(\"/mnt/c/Users/riche/ThessianSound/ThessianSoundLLC/frontend/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/mnt/c/Users/riche/ThessianSound/ThessianSoundLLC/frontend/node_modules/@babel/runtime/helpers/createClass\");\n\nvar idlUtils = require(\"../generated/utils\");\n\nvar _require = require(\"../helpers/traversal\"),\n    closest = _require.closest;\n\nvar _require2 = require(\"../helpers/form-controls\"),\n    isDisabled = _require2.isDisabled,\n    isSubmittable = _require2.isSubmittable,\n    isButton = _require2.isButton,\n    normalizeToCRLF = _require2.normalizeToCRLF;\n\nvar Blob = require(\"../generated/Blob.js\");\n\nvar File = require(\"../generated/File.js\");\n\nvar conversions = require(\"webidl-conversions\");\n\nexports.implementation = /*#__PURE__*/function () {\n  function FormDataImpl(args) {\n    _classCallCheck(this, FormDataImpl);\n\n    this._entries = [];\n\n    if (args[0] !== undefined) {\n      this._entries = constructTheFormDataSet(args[0]);\n    }\n  }\n\n  _createClass(FormDataImpl, [{\n    key: \"append\",\n    value: function append(name, value, filename) {\n      var entry = createAnEntry(name, value, filename);\n\n      this._entries.push(entry);\n    }\n  }, {\n    key: \"delete\",\n    value: function _delete(name) {\n      this._entries = this._entries.filter(function (entry) {\n        return entry.name !== name;\n      });\n    }\n  }, {\n    key: \"get\",\n    value: function get(name) {\n      var foundEntry = this._entries.find(function (entry) {\n        return entry.name === name;\n      });\n\n      return foundEntry !== undefined ? foundEntry.value : null;\n    }\n  }, {\n    key: \"getAll\",\n    value: function getAll(name) {\n      return this._entries.filter(function (entry) {\n        return entry.name === name;\n      }).map(function (entry) {\n        return entry.value;\n      });\n    }\n  }, {\n    key: \"has\",\n    value: function has(name) {\n      return this._entries.findIndex(function (entry) {\n        return entry.name === name;\n      }) !== -1;\n    }\n  }, {\n    key: \"set\",\n    value: function set(name, value, filename) {\n      var entry = createAnEntry(name, value, filename);\n\n      var foundIndex = this._entries.findIndex(function (e) {\n        return e.name === name;\n      });\n\n      if (foundIndex !== -1) {\n        this._entries[foundIndex] = entry;\n        this._entries = this._entries.filter(function (e, i) {\n          return e.name !== name || i === foundIndex;\n        });\n      } else {\n        this._entries.push(entry);\n      }\n    }\n  }, {\n    key: Symbol.iterator,\n    value: /*#__PURE__*/_regeneratorRuntime.mark(function value() {\n      var _iterator, _step, entry;\n\n      return _regeneratorRuntime.wrap(function value$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _iterator = _createForOfIteratorHelper(this._entries);\n              _context.prev = 1;\n\n              _iterator.s();\n\n            case 3:\n              if ((_step = _iterator.n()).done) {\n                _context.next = 9;\n                break;\n              }\n\n              entry = _step.value;\n              _context.next = 7;\n              return [entry.name, idlUtils.tryWrapperForImpl(entry.value)];\n\n            case 7:\n              _context.next = 3;\n              break;\n\n            case 9:\n              _context.next = 14;\n              break;\n\n            case 11:\n              _context.prev = 11;\n              _context.t0 = _context[\"catch\"](1);\n\n              _iterator.e(_context.t0);\n\n            case 14:\n              _context.prev = 14;\n\n              _iterator.f();\n\n              return _context.finish(14);\n\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, value, this, [[1, 11, 14, 17]]);\n    })\n  }]);\n\n  return FormDataImpl;\n}();\n\nfunction createAnEntry(name, value, filename) {\n  var entry = {\n    name: name\n  }; // https://github.com/whatwg/xhr/issues/75\n\n  if (Blob.isImpl(value) && !File.isImpl(value)) {\n    var oldValue = value;\n    value = File.createImpl([[], \"blob\", {\n      type: oldValue.type\n    }]); // \"representing the same bytes\"\n\n    value._buffer = oldValue._buffer;\n  }\n\n  if (File.isImpl(value) && filename !== undefined) {\n    var _oldValue = value;\n    value = File.createImpl([[], filename, // spec makes no mention of `lastModified`; assume it is inherited\n    // (Chrome's behavior)\n    {\n      type: _oldValue.type,\n      lastModified: _oldValue.lastModified\n    }]); // \"representing the same bytes\"\n\n    value._buffer = _oldValue._buffer;\n  }\n\n  entry.value = value;\n  return entry;\n}\n\nfunction constructTheFormDataSet(form, submitter) {\n  // https://html.spec.whatwg.org/multipage/forms.html#constructing-form-data-set\n  var controls = form.elements.filter(isSubmittable); // submittable is a subset of listed\n\n  var formDataSet = [];\n\n  var _iterator2 = _createForOfIteratorHelper(controls),\n      _step2;\n\n  try {\n    for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n      var fieldWrapper = _step2.value;\n      var field = fieldWrapper;\n\n      if (closest(field, \"datalist\") !== null) {\n        continue;\n      }\n\n      if (isDisabled(field)) {\n        continue;\n      }\n\n      if (isButton(field) && field !== submitter) {\n        continue;\n      }\n\n      if (field.type === \"checkbox\" && field._checkedness === false) {\n        continue;\n      }\n\n      if (field.type === \"radio\" && field._checkedness === false) {\n        continue;\n      }\n\n      if (field.type !== \"image\" && (!field.hasAttribute(\"name\") || field.getAttribute(\"name\") === \"\")) {\n        continue;\n      }\n\n      if (field.localName === \"object\") {\n        // in jsdom, no objects are \"using a plugin\"\n        continue;\n      }\n\n      var type = field.type; // Omit special processing of <input type=\"image\"> since so far we don't actually ever pass submitter\n\n      var nameAttr = field.getAttribute(\"name\");\n      var name = nameAttr === null ? \"\" : nameAttr;\n\n      if (field.localName === \"select\") {\n        var _iterator3 = _createForOfIteratorHelper(field.options),\n            _step3;\n\n        try {\n          for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n            var option = _step3.value;\n\n            if (option._selectedness === true && !isDisabled(field)) {\n              formDataSet.push({\n                name: name,\n                value: option.value,\n                type: type\n              });\n            }\n          }\n        } catch (err) {\n          _iterator3.e(err);\n        } finally {\n          _iterator3.f();\n        }\n      } else if (field.localName === \"input\" && (type === \"checkbox\" || type === \"radio\")) {\n        var _value = field.hasAttribute(\"value\") ? field.getAttribute(\"value\") : \"on\";\n\n        formDataSet.push({\n          name: name,\n          value: _value,\n          type: type\n        });\n      } else if (type === \"file\") {\n        for (var i = 0; i < field.files.length; ++i) {\n          formDataSet.push({\n            name: name,\n            value: field.files.item(i),\n            type: type\n          });\n        }\n\n        if (field.files.length === 0) {\n          formDataSet.push({\n            name: name,\n            value: \"\",\n            type: \"application/octet-stream\"\n          });\n        }\n      }\n      /* skip plugins */\n      else {\n          formDataSet.push({\n            name: name,\n            value: field._getValue(),\n            type: type\n          });\n        }\n\n      var dirname = field.getAttribute(\"dirname\");\n\n      if (dirname !== null && dirname !== \"\") {\n        var dir = \"ltr\"; // jsdom does not (yet?) implement actual directionality\n\n        formDataSet.push({\n          name: dirname,\n          value: dir,\n          type: \"direction\"\n        });\n      }\n    }\n  } catch (err) {\n    _iterator2.e(err);\n  } finally {\n    _iterator2.f();\n  }\n\n  for (var _i = 0, _formDataSet = formDataSet; _i < _formDataSet.length; _i++) {\n    var entry = _formDataSet[_i];\n    entry.name = conversions.USVString(normalizeToCRLF(entry.name));\n\n    if (entry.type !== \"file\" && entry.type !== \"textarea\") {\n      entry.value = normalizeToCRLF(entry.value);\n    }\n\n    if (entry.type !== \"file\") {\n      entry.value = conversions.USVString(entry.value);\n    }\n  }\n\n  return formDataSet;\n}","map":{"version":3,"sources":["/mnt/c/Users/riche/ThessianSound/ThessianSoundLLC/frontend/node_modules/jsdom/lib/jsdom/living/xhr/FormData-impl.js"],"names":["idlUtils","require","closest","isDisabled","isSubmittable","isButton","normalizeToCRLF","Blob","File","conversions","exports","implementation","args","_entries","undefined","constructTheFormDataSet","name","value","filename","entry","createAnEntry","push","filter","foundEntry","find","map","findIndex","foundIndex","e","i","Symbol","iterator","tryWrapperForImpl","isImpl","oldValue","createImpl","type","_buffer","lastModified","form","submitter","controls","elements","formDataSet","fieldWrapper","field","_checkedness","hasAttribute","getAttribute","localName","nameAttr","options","option","_selectedness","files","length","item","_getValue","dirname","dir","USVString"],"mappings":"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","sourcesContent":["\"use strict\";\nconst idlUtils = require(\"../generated/utils\");\nconst { closest } = require(\"../helpers/traversal\");\nconst { isDisabled, isSubmittable, isButton, normalizeToCRLF } = require(\"../helpers/form-controls\");\nconst Blob = require(\"../generated/Blob.js\");\nconst File = require(\"../generated/File.js\");\nconst conversions = require(\"webidl-conversions\");\n\nexports.implementation = class FormDataImpl {\n  constructor(args) {\n    this._entries = [];\n\n    if (args[0] !== undefined) {\n      this._entries = constructTheFormDataSet(args[0]);\n    }\n  }\n\n  append(name, value, filename) {\n    const entry = createAnEntry(name, value, filename);\n    this._entries.push(entry);\n  }\n\n  delete(name) {\n    this._entries = this._entries.filter(entry => entry.name !== name);\n  }\n\n  get(name) {\n    const foundEntry = this._entries.find(entry => entry.name === name);\n    return foundEntry !== undefined ? foundEntry.value : null;\n  }\n\n  getAll(name) {\n    return this._entries.filter(entry => entry.name === name).map(entry => entry.value);\n  }\n\n  has(name) {\n    return this._entries.findIndex(entry => entry.name === name) !== -1;\n  }\n\n  set(name, value, filename) {\n    const entry = createAnEntry(name, value, filename);\n\n    const foundIndex = this._entries.findIndex(e => e.name === name);\n    if (foundIndex !== -1) {\n      this._entries[foundIndex] = entry;\n      this._entries = this._entries.filter((e, i) => e.name !== name || i === foundIndex);\n    } else {\n      this._entries.push(entry);\n    }\n  }\n\n  * [Symbol.iterator]() {\n    for (const entry of this._entries) {\n      yield [entry.name, idlUtils.tryWrapperForImpl(entry.value)];\n    }\n  }\n};\n\nfunction createAnEntry(name, value, filename) {\n  const entry = { name };\n\n  // https://github.com/whatwg/xhr/issues/75\n\n  if (Blob.isImpl(value) && !File.isImpl(value)) {\n    const oldValue = value;\n    value = File.createImpl([\n      [],\n      \"blob\",\n      { type: oldValue.type }\n    ]);\n    // \"representing the same bytes\"\n    value._buffer = oldValue._buffer;\n  }\n\n  if (File.isImpl(value) && filename !== undefined) {\n    const oldValue = value;\n    value = File.createImpl([\n      [],\n      filename,\n      // spec makes no mention of `lastModified`; assume it is inherited\n      // (Chrome's behavior)\n      { type: oldValue.type, lastModified: oldValue.lastModified }\n    ]);\n    // \"representing the same bytes\"\n    value._buffer = oldValue._buffer;\n  }\n\n  entry.value = value;\n\n  return entry;\n}\n\nfunction constructTheFormDataSet(form, submitter) {\n  // https://html.spec.whatwg.org/multipage/forms.html#constructing-form-data-set\n\n  const controls = form.elements.filter(isSubmittable); // submittable is a subset of listed\n  const formDataSet = [];\n\n  for (const fieldWrapper of controls) {\n    const field = fieldWrapper;\n\n    if (closest(field, \"datalist\") !== null) {\n      continue;\n    }\n    if (isDisabled(field)) {\n      continue;\n    }\n    if (isButton(field) && field !== submitter) {\n      continue;\n    }\n    if (field.type === \"checkbox\" && field._checkedness === false) {\n      continue;\n    }\n    if (field.type === \"radio\" && field._checkedness === false) {\n      continue;\n    }\n    if (field.type !== \"image\" && (!field.hasAttribute(\"name\") || field.getAttribute(\"name\") === \"\")) {\n      continue;\n    }\n    if (field.localName === \"object\") { // in jsdom, no objects are \"using a plugin\"\n      continue;\n    }\n\n    const { type } = field;\n\n    // Omit special processing of <input type=\"image\"> since so far we don't actually ever pass submitter\n\n    const nameAttr = field.getAttribute(\"name\");\n    const name = nameAttr === null ? \"\" : nameAttr;\n\n    if (field.localName === \"select\") {\n      for (const option of field.options) {\n        if (option._selectedness === true && !isDisabled(field)) {\n          formDataSet.push({ name, value: option.value, type });\n        }\n      }\n    } else if (field.localName === \"input\" && (type === \"checkbox\" || type === \"radio\")) {\n      const value = field.hasAttribute(\"value\") ? field.getAttribute(\"value\") : \"on\";\n      formDataSet.push({ name, value, type });\n    } else if (type === \"file\") {\n      for (let i = 0; i < field.files.length; ++i) {\n        formDataSet.push({ name, value: field.files.item(i), type });\n      }\n\n      if (field.files.length === 0) {\n        formDataSet.push({ name, value: \"\", type: \"application/octet-stream\" });\n      }\n    } /* skip plugins */ else {\n      formDataSet.push({ name, value: field._getValue(), type });\n    }\n\n    const dirname = field.getAttribute(\"dirname\");\n    if (dirname !== null && dirname !== \"\") {\n      const dir = \"ltr\"; // jsdom does not (yet?) implement actual directionality\n      formDataSet.push({ name: dirname, value: dir, type: \"direction\" });\n    }\n  }\n\n  for (const entry of formDataSet) {\n    entry.name = conversions.USVString(normalizeToCRLF(entry.name));\n\n    if (entry.type !== \"file\" && entry.type !== \"textarea\") {\n      entry.value = normalizeToCRLF(entry.value);\n    }\n\n    if (entry.type !== \"file\") {\n      entry.value = conversions.USVString(entry.value);\n    }\n  }\n\n  return formDataSet;\n}\n"]},"metadata":{},"sourceType":"script"}